!function(t,e,o){function n(t){throw new Error(s.text.prefix+"Error: "+t)}function i(t,e,o,i,a){switch(t&&e||n('Argument "$toast" or "type" is not provided in $toastErr.'),o||console.log(s.text.prefix+"Caution: No toast content provided."),o=o||"（木有提供提示消息~）",a=a||void 0,e){case"simple":t.showSimpleToast(o);break;case"action":i?void 0:n('Please provide parama "action" when calling '+a),t.showActionToast(o,i,a)}}function a(t,e,o,a){i(t,"action",e,o,function(){n(a)})}function r(t,e){r.isRunning=!0,t.style.backgroundPositionX=e.startPosition+"px";var n=1,i=setInterval(function(){return n>e.step?(e.endPosition!=o?t.style.backgroundPositionX=e.endPosition+"px":void 0,clearInterval(i),void(r.isRunning=!1)):(t.style.backgroundPositionX=e.startPosition+e.width*n+"px",void n++)},e.interval)}function c(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function l(t,e){c(t,e)||(t.className+=" "+e)}!function(){function o(){throw t.location.href="/old-browser",new Error("Animation Searcher Error: Your Browser is too old, time to change! :)")}if(!e)throw new Error("Animation Searcher Error: Please make sure Angular.JS is loaded Correctly.");var n=t.navigator.userAgent,i=/MSIE [1-8].*]/i;n.match(i)?o():void 0}();var s={text:{prefix:"Animation Searcher "},site:{caso:{name:"华盟",codeName:"caso",fullName:"China Animation Subtitle Organization",url:"https://camoe.org",icon:"http://tp4.sinaimg.cn/1843885343/180/1290319229/0",disabled:!1},ktxp:{name:"极影",codeName:"ktxp",fullName:"Katong XP",url:"http://bt.ktxp.org",icon:"http://tp4.sinaimg.cn/3808818207/180/5680524263/0",disabled:!1},popgo:{name:"漫游",codeName:"popgo",fullName:"Popgo",url:"http://share.popgo.com",icon:"http://tp1.sinaimg.cn/2661910672/180/5727241391/0",disabled:!1},dmhy:{name:"动漫花园",codeName:"dmhy",fullName:"DongMan HuaYuan",url:"http://share.dmhy.org",icon:"http://tp2.sinaimg.cn/1926582581/180/22817929400/0",disabled:!1}},toast:{position:{top:!0,bottom:!1,left:!1,right:!0}}};r.isRunning=!1;var u=e.module("ngApp",["ngAnimate","ngMaterial","ngSanitize","ngRoute","ngAppCtrls","ngAppDirectives","ngAppToast","ngCharMsg","ngLeftNav","ngColorChange","ngLocalStorage","ngSplashLayout"]),m=e.module("ngAppCtrls",[]);m.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|magnet):/)}]);var d=e.module("ngAppDirectives",[]),f=e.module("ngAppToast",[]);f.factory("$toast",function(t){var e={};return e.toastPosition=s.toast.position,e.getToastPosition=function(){return Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")},e.showSimpleToast=function(o){t.show(t.simple().content(o).position(e.getToastPosition()).hideDelay(5e3))},e.showActionToast=function(o,n,i){i=i||function(){};var a=t.simple().content(o).action(n).highlightAction(!1).position(e.getToastPosition());t.show(a).then(i)},e.closeToast=function(){t.hide()},e});var p=e.module("ngCharMsg",[]);p.factory("$charMsg",function(t,o){var i=e.element(document.querySelector("body")),a=!1,r=null,c=null,s={create:function(e,o,c){if(o||n('param "content" must be provided when calling "$charMsg.show()".'),r&&n("\n\n Character Message Panel has been created, can't create anymore, so stop calling me before remove it! （╯－＿－）╯╧╧ \n"),!a){a=!0,r=document.createElement("char-msg"),r.className="char-msg";var u=document.createElement("div");switch(u.className="char-msg-container",c=c||"left"){case"left":l(r,"left");break;case"right":l(r,"right")}if(e){var m=document.createElement("h2");m.className="char-msg-title",m.innerHTML=e,u.appendChild(m)}var d=document.createElement("div");d.className="char-msg-content",d.innerHTML=o,u.appendChild(d);var f=document.createElement("button");f.className="char-msg-close-btn",f.onclick=s.remove;var p=document.createElement("i");p.className="icon-cancel",f.appendChild(p),u.appendChild(f),r.appendChild(u),i.append(r),t(function(){a=!1},500)}},remove:function(e){l(r,"out-animation"),c=t(function(){r.parentNode.removeChild(r),r=null,e?e():void 0},500)}};return{show:s.create,hide:s.remove}});var g=e.module("ngLocalStorage",[]);g.factory("$localStorage",function(e){function o(e,o){e&&o||n('Params must be provided when calling "$localStorage.setItem()"!  (╯‵□′)╯︵┻━┻'),"[object String]"!==Object.prototype.toString.call(e)&&n('$localStorage.setItem(): Param "key" must be String.'),t.localStorage.setItem(e,o)}function i(e){return e&&"[object String]"===Object.prototype.toString.call(e)||n('$localStorage.getItem(): Params "key" is invalid, take a look.'),t.localStorage.getItem(e)}function a(e){e&&"[object String]"===Object.prototype.toString.call(e)||n('$localStorage.removeItem(): Params "key" is invalid, take a look.'),t.localStorage.removeItem(e)}function r(){Object.keys(t.localStorage).filter(function(t){a(t)}),e.showSimpleToast("搜索历史已成功清空!  (●'◡'●)ﾉ♥"),console.log(s.text.prefix+"Info:\nAll items in Local Storage has been removed at "+new Date(Date.now())+".")}return{setItem:o,getItem:i,removeItem:a,empty:r}});var h=e.module("ngLeftNav",[]);h.factory("$leftNav",function(o,n,i){function a(t){27===t.keyCode&&(m(),s())}function c(){f.unbind("keyup",a)}function l(){o("leftside").toggle().then(function(){}),n(function(){var t=e.element(document.querySelector("md-backdrop"));t.unbind(),n(function(){t.bind("click",d)},400),o("leftside").isOpen()&&f.bind("keyup",a)},1)}function s(){o("leftside").close(),m("close")}function u(){o("leftside").isOpen()||(l(),m("open"),n(function(){var t=e.element(document.querySelector("md-backdrop"));t.removeClass("ng-enter")},1))}function m(t){var e=document.getElementById("left-nav-menu"),o={toArrow:function(){var t={startPosition:0,width:27.75,step:16,interval:17};r(e,t),e.setAttribute("data-status","arrow"),i.path("/side-nav-open")},toMenu:function(){var t={startPosition:444,endPosition:0,width:27.75,step:16,interval:17};r(e,t),e.setAttribute("data-status","menu"),c(),i.path("/")}},n=e.getAttribute("data-status");if(t)switch(t){case"open":if("arrow"===n)return;o.toArrow();break;case"close":if("menu"===n)return;o.toMenu()}else switch(n){case"menu":o.toArrow();break;case"arrow":o.toMenu()}}function d(){return r.isRunning?!1:(l(),void m())}var f=e.element(t);return{toggle:d,open:u,close:s}});var v=e.module("ngColorChange",[]);v.factory("$colorChange",function(){function t(t){var e=".color-theme.bk-color {background-color:"+t+"}.color-theme.text-color {color:"+t+"}";n.html(e)}var o=document.getElementById("color-change"),n=e.element(o);return{change:t}});var w=e.module("ngSplashLayout",[]);w.factory("$splashLayout",function(t){function e(){t.layout=n.initLayout}function o(){t.layout=n.standBy}var n={initLayout:"init-layout",standBy:"stand-by-layout"};return console.log("aaa"),t.layout=n.initLayout,{toInitLayout:e,toStandByLayout:o,layout:t.layout}}),u.config(["$routeProvider",function(t){t.when("/change-log",{template:"",controller:function(t,e,o,n){e.post("/change-log").then(function(t){n.show(t.data.title,t.data.content)},function(t){a(o,"更新日志获取失败, 过一会再试试?","(/= _ =)/~┴┴","Request for Change Log failed.")})}}).when("/init-layout",{template:"",controller:function(t){t.toInitLayout()}}).when("/side-nav-open",{template:"",controller:function(t){t.open()}}).when("/",{template:"",controller:function(t){t.close()}})}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0})}]),m.controller("mainController",["$scope","$rootScope","$splashLayout",function(t,e,o){console.log(e.layout),t.progressStatus={},function(){Object.keys(s.site).filter(function(e){t.progressStatus[e]=!1})}(),t.searchResult={}}]),m.controller("leftNavButtonCtrl",function(t,e,o,n,i,a){t.clearHistory=function(){a.empty()}}),d.directive("actionBar",function(){return{restrict:"E",scope:{},controller:function(t,e,o){},link:function(t,e,o){}}}),d.directive("leftnavMenu",function(t){return{restrict:"E",scope:!0,controller:function(t,e,o){},link:function(e,o,n){e.toggle=t.toggle}}}),d.directive("searchBar",function(t){return{restrict:"E",scope:!0,controller:function(t,e,o,n){},link:function(e,o,n){e.keywords=null,e.searchExec=function(){Object.keys(s.site).filter(function(o){$http.post("/search/"+s.site[o].codeName,{keywords:e.keywords}).success(function(e,n,i,a){$scope.searchResult[o]=e.result,t.toast.showSimpleToast(e.info)}).error(function(e,o,n,i){t.toast.showActionToast(e.info,e.action)})})}}}}),d.directive("siteSwitcher",function(){return{restrict:"E",scope:!0,replace:!0,templateUrl:"/templates/ng-site-switcher.html",controller:function(t,e,o){t.panelSwitch=function(t){t?void 0:n('Please provide param "codeName" while calling this function.')}},link:function(t,e,o){t.switcherList=s.site,Object.keys(t.switcherList).filter(function(e){t.switcherList[e].title="切换至"+t.switcherList[e].name+"的搜索结果"})}}}),d.directive("resultPanel",function(){return{restrict:"E",scope:!0,templateUrl:"/templates/ng-result-panel.html",controller:function(t,e,o,i,a,r){o.codename?void 0:n('Attribute "codename" must be defined.');var c=o.codename;t.domInfo={codeName:c,name:s.site[c].name,fullName:s.site[c].fullName,icon:s.site[c].icon,disabled:s.site[c].disabled},t.result=t.searchResult},link:function(t,e,o){o.codename?void 0:n('Attribute "codename" must be defined.')}}})}(window,window.angular),function(t,e,o){function n(){if(!t.io)throw new Error(i+"Error: Socket.io isn't loaded yet, scripts has been stoped.");var e=t.io();e.on("greeting",function(t){console.log(i+"Info: WebSocket from now on. :)"),e.emit("thank-you-sir",{info:"啊♂啊♂Thank♂You♂Sir"})})}var i="Animation Searcher ";e.element(window).on("load",n)}(window,window.angular);