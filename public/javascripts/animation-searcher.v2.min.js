!function(t,e){function n(){throw t.location.href="/old-browser",new Error("Animation Searcher Error: Your Browser is too old, time to change! :)")}if(!angular)throw new Error("Animation Searcher Error: Please make sure Angular.JS is loaded Correctly.");var o=t.navigator.userAgent,a=/MSIE [1-8].*]/i;o.match(a)?n():void 0}(window),function(){"use strict";var t=angular.module("appConfig",[]);t.value("appConfig",{text:{prefix:"Animation Searcher "},site:{caso:{name:"华盟",codeName:"caso",fullName:"China Animation Subtitle Organization",url:"https://camoe.org",icon:"http://tp4.sinaimg.cn/1843885343/180/1290319229/0",disabled:!1},ktxp:{name:"极影",codeName:"ktxp",fullName:"Katong XP",url:"http://bt.ktxp.org",icon:"http://tp4.sinaimg.cn/3808818207/180/5680524263/0",disabled:!1},popgo:{name:"漫游",codeName:"popgo",fullName:"Popgo",url:"http://share.popgo.com",icon:"http://tp1.sinaimg.cn/2661910672/180/5727241391/0",disabled:!1},dmhy:{name:"动漫花园",codeName:"dmhy",fullName:"DongMan HuaYuan",url:"http://share.dmhy.org",icon:"http://tp2.sinaimg.cn/1926582581/180/22817929400/0",disabled:!1}},toast:{position:{top:!0,bottom:!1,left:!1,right:!0}}})}(),function(){"use strict";angular.module("ngApp",["ngAnimate","ngMaterial","ngSanitize","ngRoute","appConfig","internalFunc","ngAppCtrls","ngAppDirectives","ngAppToast","ngCharMsg","ngLeftNav","ngColorChange","ngLocalStorage","ngSplashLayout","ngChangeLog"])}(),function(){"use strict";var t=angular.module("ngAppCtrls",[]);t.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|magnet):/)}]),t.controller("mainController",["$scope","$rootScope","appConfig",function(t,e,n){t.progressStatus={},function(){Object.keys(n.site).filter(function(e){t.progressStatus[e]=!1})}(),t.searchResult={}}]),t.controller("leftNavButtonCtrl",["$scope","$http","$toast","$leftNav","$charMsg","$localStorage",function(t,e,n,o,a,r){t.clearHistory=function(){r.empty()}}]),t.controller("changeLogCtrl",["$scope","$changeLog",function(t,e){}])}(),function(){"use strict";var t=angular.module("ngAppDirectives",[]);t.directive("actionBar",function(){return{restrict:"E",scope:{},controller:function(t,e,n){},link:function(t,e,n){}}}),t.directive("leftnavMenu",["$leftNav",function(t){return{restrict:"E",scope:!0,controller:function(t,e,n){},link:function(e,n,o){e.toggle=t.toggle}}}]),t.directive("searchBar",function(t){return{restrict:"E",scope:!0,controller:function(t,e,n,o){},link:function(e,n,o){e.keywords=null,e.searchExec=function(){Object.keys(moduleSettings.site).filter(function(n){$http.post("/search/"+moduleSettings.site[n].codeName,{keywords:e.keywords}).success(function(e,o,a,r){$scope.searchResult[n]=e.result,t.toast.showSimpleToast(e.info)}).error(function(e,n,o,a){t.toast.showActionToast(e.info,e.action)})})}}}}),t.directive("siteSwitcher",function(){return{restrict:"E",scope:!0,replace:!0,templateUrl:"/templates/ng-site-switcher.html",controller:function(t,e,n){t.panelSwitch=function(t){t?void 0:throwError('Please provide param "codeName" while calling this function.')}},link:function(t,e,n){t.switcherList=moduleSettings.site,Object.keys(t.switcherList).filter(function(e){t.switcherList[e].title="切换至"+t.switcherList[e].name+"的搜索结果"})}}}),t.directive("resultPanel",function(){return{restrict:"E",scope:!0,templateUrl:"/templates/ng-result-panel.html",controller:function(t,e,n,o,a,r){n.codename?void 0:throwError('Attribute "codename" must be defined.');var i=n.codename;t.domInfo={codeName:i,name:moduleSettings.site[i].name,fullName:moduleSettings.site[i].fullName,icon:moduleSettings.site[i].icon,disabled:moduleSettings.site[i].disabled},t.result=t.searchResult},link:function(t,e,n){n.codename?void 0:throwError('Attribute "codename" must be defined.')}}})}(),function(){function t(t){throw new Error(moduleSettings.text.prefix+"Error: "+t)}function e(e,n,o,a,r){switch(e&&n||t('Argument "$toast" or "type" is not provided in $toastErr.'),o||console.log(moduleSettings.text.prefix+"Caution: No toast content provided."),o=o||"（木有提供提示消息~）",r=r||void 0,n){case"simple":e.showSimpleToast(o);break;case"action":a?void 0:t('Please provide parama "action" when calling '+r),e.showActionToast(o,a,r)}}function n(n,o,a,r){e(n,"action",o,a,function(){t(r)})}function o(t,e){o.isRunning=!0,t.style.backgroundPositionX=e.startPosition+"px";var n=1,a=setInterval(function(){return n>e.step?(void 0!=e.endPosition?t.style.backgroundPositionX=e.endPosition+"px":void 0,clearInterval(a),void(o.isRunning=!1)):(t.style.backgroundPositionX=e.startPosition+e.width*n+"px",void n++)},e.interval)}function a(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function r(t,e){a(t,e)||(t.className+=" "+e)}function i(t,e){a(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," "))}function c(t,e){t.className=e}function s(t,e){return t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e),t}o.isRunning=!1;var l=angular.module("internalFunc",[]);l.factory("$internalFunc",function(){return{throwError:t,toastFunc:e,toastErr:n,imageAnimationX:o,hasClass:a,addClass:r,removeClass:i,setClass:c,prependChild:s}})}(),function(){"use strict";var t=angular.module("ngApp");t.config(["$routeProvider",function(t){t.when("/change-log",{template:"",controller:function(t){t.show()}}).when("/welcome",{template:"",controller:function(t){t.toInitLayout()}}).when("/stand-by",{template:"",controller:function(t){t.toStandByLayout()}}).when("/side-nav-open",{template:"",controller:function(t,e){t.open(),e.toStandByLayout()}}).when("/",{template:"",controller:function(t,e){t.close(),e.hide()}})}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0})}])}(),function(t,e){"use strict";var n=angular.module("ngAppToast",[]);n.factory("$toast",["$mdToast","appConfig",function(t,e){var n={};return n.toastPosition=e.toast.position,n.getToastPosition=function(){return Object.keys(n.toastPosition).filter(function(t){return n.toastPosition[t]}).join(" ")},n.showSimpleToast=function(e){t.show(t.simple().content(e).position(n.getToastPosition()).hideDelay(5e3))},n.showActionToast=function(e,o,a){a=a||function(){};var r=t.simple().content(e).action(o).highlightAction(!1).position(n.getToastPosition());t.show(r).then(a)},n.closeToast=function(){t.hide()},n}]);var o=angular.module("ngCharMsg",[]);o.factory("$charMsg",function(t,e){var n=angular.element(document.querySelector("body")),o=!1,a=null,r=null,i={create:function(r,c,s){if(c||e.throwError('param "content" must be provided when calling "$charMsg.show()".'),a&&e.throwError("\n\n Character Message Panel has been created, can't create anymore, so stop calling me before remove it! （╯－＿－）╯╧╧ \n"),!o){o=!0,a=document.createElement("char-msg"),a.className="char-msg";var l=document.createElement("div");switch(l.className="char-msg-container",s=s||"left"){case"left":addClass(a,"left");break;case"right":addClass(a,"right")}if(r){var u=document.createElement("h2");u.className="char-msg-title",u.innerHTML=r,l.appendChild(u)}var m=document.createElement("div");m.className="char-msg-content",m.innerHTML=c,l.appendChild(m);var d=document.createElement("button");d.className="char-msg-close-btn",d.onclick=i.remove;var g=document.createElement("i");g.className="icon-cancel",d.appendChild(g),l.appendChild(d),a.appendChild(l),n.append(a),t(function(){o=!1},500)}},remove:function(e){addClass(a,"out-animation"),r=t(function(){a.parentNode.removeChild(a),a=null,e?e():void 0},500)}};return{show:i.create,hide:i.remove}});var a=angular.module("ngLocalStorage",[]);a.factory("$localStorage",function(e,n,o){function a(e,o){e&&o||n.throwError('Params must be provided when calling "$localStorage.setItem()"!  (╯‵□′)╯︵┻━┻'),"[object String]"!==Object.prototype.toString.call(e)&&n.throwError('$localStorage.setItem(): Param "key" must be String.'),t.localStorage.setItem(e,o)}function r(e){return e&&"[object String]"===Object.prototype.toString.call(e)||n.throwError('$localStorage.getItem(): Params "key" is invalid, take a look.'),t.localStorage.getItem(e)}function i(e){e&&"[object String]"===Object.prototype.toString.call(e)||n.throwError('$localStorage.removeItem(): Params "key" is invalid, take a look.'),t.localStorage.removeItem(e)}function c(){Object.keys(t.localStorage).filter(function(t){i(t)}),e.showSimpleToast("搜索历史已成功清空!  (●'◡'●)ﾉ♥"),console.log(o.text.prefix+"Info:\nAll items in Local Storage has been removed at "+new Date(Date.now())+".")}return{setItem:a,getItem:r,removeItem:i,empty:c}});var r=angular.module("ngLeftNav",[]);r.factory("$leftNav",function(e,n,o,a){function r(t){27===t.keyCode&&(u(),s())}function i(){d.unbind("keyup",r)}function c(){e("leftside").toggle().then(function(){}),n(function(){var t=angular.element(document.querySelector("md-backdrop"));t.unbind(),n(function(){t.bind("click",m)},400),e("leftside").isOpen()&&d.bind("keyup",r)},1)}function s(){e("leftside").close(),u("close")}function l(){e("leftside").isOpen()||(c(),u("open"),n(function(){var t=angular.element(document.querySelector("md-backdrop"));t.removeClass("ng-enter")},1))}function u(t){var e=document.getElementById("left-nav-menu"),n={toArrow:function(){var t={startPosition:0,width:27.75,step:16,interval:17};a.imageAnimationX(e,t),e.setAttribute("data-status","arrow"),o.path("/side-nav-open")},toMenu:function(){var t={startPosition:444,endPosition:0,width:27.75,step:16,interval:17};a.imageAnimationX(e,t),e.setAttribute("data-status","menu"),i(),o.path("/")}},r=e.getAttribute("data-status");if(t)switch(t){case"open":if("arrow"===r)return;n.toArrow();break;case"close":if("menu"===r)return;n.toMenu()}else switch(r){case"menu":n.toArrow();break;case"arrow":n.toMenu()}}function m(){return a.imageAnimationX.isRunning?!1:(c(),void u())}var d=angular.element(t);return{toggle:m,open:l,close:s}});var i=angular.module("ngColorChange",[]);i.factory("$colorChange",function(){function t(t){var e=".color-theme.bk-color {background-color:"+t+"}.color-theme.text-color {color:"+t+"}";n.html(e)}var e=document.getElementById("color-change"),n=angular.element(e);return{change:t}});var c=angular.module("ngSplashLayout",[]);c.factory("$splashLayout",function(){function t(){}function e(){}var n=null;return{toInitLayout:t,toStandByLayout:e,layout:n}});var s=angular.module("ngChangeLog",[]);s.service("$changeLog",function(t,e,n,o,a){function r(){t.post("/change-log").then(function(t){e.toStandByLayout(),c.panelStatus="show"},function(t){a.toastErr(o,"更新日志获取失败, 过一会再试试?","(/= _ =)/~┴┴","Request for Change Log failed.")})}function i(){c.panelStatus="hide"}var c=this;this.show=r,this.hide=i})}(window),function(t,e,n){function o(){if(!t.io)throw new Error(a+"Error: Socket.io isn't loaded yet, scripts has been stoped.");var e=t.io();e.on("greeting",function(t){console.log(a+"Info: WebSocket from now on. :)"),e.emit("thank-you-sir",{info:"啊♂啊♂Thank♂You♂Sir"})})}var a="Animation Searcher ";e.element(window).on("load",o)}(window,window.angular);