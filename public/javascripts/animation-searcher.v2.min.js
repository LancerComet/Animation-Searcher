!function(t,e){function n(){throw t.location.href="/old-browser",new Error("Animation Searcher Error: Your Browser is too old, time to change! :)")}if(!angular)throw new Error("Animation Searcher Error: Please make sure Angular.JS is loaded Correctly.");var o=t.navigator.userAgent,a=/MSIE [1-8].*]/i;o.match(a)?n():void 0}(window),function(){"use strict";var t=angular.module("appConfig",[]);t.value("appConfig",{text:{prefix:"Animation Searcher "},site:{caso:{name:"华盟",codeName:"caso",fullName:"China Animation Subtitle Organization",url:"https://camoe.org",icon:"http://tp4.sinaimg.cn/1843885343/180/1290319229/0",disabled:!1},ktxp:{name:"极影",codeName:"ktxp",fullName:"Katong XP",url:"http://bt.ktxp.org",icon:"http://tp4.sinaimg.cn/3808818207/180/5680524263/0",disabled:!1},popgo:{name:"漫游",codeName:"popgo",fullName:"Popgo",url:"http://share.popgo.com",icon:"http://tp1.sinaimg.cn/2661910672/180/5727241391/0",disabled:!1},dmhy:{name:"动漫花园",codeName:"dmhy",fullName:"DongMan HuaYuan",url:"http://share.dmhy.org",icon:"http://tp2.sinaimg.cn/1926582581/180/22817929400/0",disabled:!1}},toast:{position:{top:!0,bottom:!1,left:!1,right:!0}}})}(),function(){"use strict";var t=angular.module("ngApp",["ngAnimate","ngMaterial","ngSanitize","ngRoute","appConfig","internalFunc","ngAppCtrls","ngAppDirectives","appToast","charMsg","leftNav","colorChange","localStorage","splashLayout","changeLog","textPanel"]);t.run(function(t){t.help()})}(),function(){"use strict";var t=angular.module("ngAppCtrls",[]);t.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|magnet):/)}]).controller("mainController",["$scope","$rootScope","$location","appConfig","$splashLayout",function(t,e,n,o,a){t.splashLayout=a,t.layout=a.layout.status,t.$watch("splashLayout",function(e,n){t.layout=e.layout.status},!0),t.progressStatus={},function(){Object.keys(o.site).filter(function(e){t.progressStatus[e]=!1})}(),t.searchResult={},console.log(t)}]),t.controller("searchController",["$scope",function(t){function e(){}function n(){}function o(){}t.searchBarFocus=e,t.searchBarBlur=n,t.searchBarKeyDown=o}]),t.controller("leftNavButtonCtrl",["$scope","$http","$toast","$leftNav","$charMsg","$localStorage",function(t,e,n,o,a,i){t.clearHistory=function(){i.empty()}}])}(),function(){"use strict";var t=angular.module("ngAppDirectives",[]);t.directive("actionBar",function(){return{restrict:"E",scope:{},controller:function(t,e,n){},link:function(t,e,n){}}}),t.directive("leftnavMenu",["$leftNav",function(t){return{restrict:"E",scope:!0,controller:function(t,e,n){},link:function(e,n,o){e.toggle=t.toggle}}}]),t.directive("searchBar",function(t){return{restrict:"E",scope:!0,controller:function(t,e,n,o){},link:function(e,n,o){e.keywords=null,e.searchExec=function(){Object.keys(moduleSettings.site).filter(function(n){$http.post("/search/"+moduleSettings.site[n].codeName,{keywords:e.keywords}).success(function(e,o,a,i){$scope.searchResult[n]=e.result,t.toast.showSimpleToast(e.info)}).error(function(e,n,o,a){t.toast.showActionToast(e.info,e.action)})})}}}}),t.directive("siteSwitcher",function(){return{restrict:"E",scope:!0,replace:!0,templateUrl:"/templates/ng-site-switcher.html",controller:function(t,e,n){t.panelSwitch=function(t){t?void 0:throwError('Please provide param "codeName" while calling this function.')}},link:function(t,e,n){t.switcherList=moduleSettings.site,Object.keys(t.switcherList).filter(function(e){t.switcherList[e].title="切换至"+t.switcherList[e].name+"的搜索结果"})}}}),t.directive("resultPanel",function(){return{restrict:"E",scope:!0,templateUrl:"/templates/ng-result-panel.html",controller:function(t,e,n,o,a,i){n.codename?void 0:throwError('Attribute "codename" must be defined.');var r=n.codename;t.domInfo={codeName:r,name:moduleSettings.site[r].name,fullName:moduleSettings.site[r].fullName,icon:moduleSettings.site[r].icon,disabled:moduleSettings.site[r].disabled},t.result=t.searchResult},link:function(t,e,n){n.codename?void 0:throwError('Attribute "codename" must be defined.')}}}),t.directive("textPanel",function(){return{restrict:"E",controller:["$scope","$element","$attrs","$compile","$timeout","$window","$toast",function(t,e,n,o,a,i,r){function c(n){n.content?void 0:r.showSimpleToast("Caution: No content provided.");var c='<div class="main-container w-100 h-100 p-absolute p-zero" style="z-index: 10000"><div class="content-container p-relative"><h2 class="title">'+n.title+'</h2><md-button class="md-icon-button close-btn" ng-click="closePanel()"><i class="icon-cancel"></i></md-button><div class="content">'+n.content+"</div></div></div>";e.append(o(c)(t)),t.panelStatus="in",t.closePanel=function(){n.backward?i.history.back():void 0,t.panelStatus="out",a(function(){angular.element(e).empty()},600)}}t.closePanel=null,t.panelStatus="out",t.$on("textPanelCreated",function(t,e){c(e)})}],link:function(t,e,n){}}})}(),function(){"use strict";function t(t){throw new Error(moduleSettings.text.prefix+"Error: "+t)}function e(e,n,o,a,i){switch(e&&n||t('Argument "$toast" or "type" is not provided in $toastErr.'),o||console.log(moduleSettings.text.prefix+"Caution: No toast content provided."),o=o||"（木有提供提示消息~）",i=i||void 0,n){case"simple":e.showSimpleToast(o);break;case"action":a?void 0:t('Please provide parama "action" when calling '+i),e.showActionToast(o,a,i)}}function n(n,o,a,i){e(n,"action",o,a,function(){t(i)})}function o(t,e){o.isRunning=!0,t.style.backgroundPositionX=e.startPosition+"px";var n=1,a=setInterval(function(){return n>e.step?(void 0!=e.endPosition?t.style.backgroundPositionX=e.endPosition+"px":void 0,clearInterval(a),void(o.isRunning=!1)):(t.style.backgroundPositionX=e.startPosition+e.width*n+"px",void n++)},e.interval)}function a(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function i(t,e){a(t,e)||(t.className+=" "+e)}function r(t,e){a(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," "))}function c(t,e){t.className=e}function l(t,e){return t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e),t}var s=angular.module("internalFunc",[]);s.factory("$internalFunc",function(){return{throwError:t,toastFunc:e,toastErr:n,imageAnimationX:o,hasClass:a,addClass:i,removeClass:r,setClass:c,prependChild:l}}),o.isRunning=!1}(),function(){"use strict";var t=angular.module("ngApp");t.config(["$routeProvider",function(t){t.when("/change-log",{template:"",controller:function(t){t.show()}}).when("/welcome",{template:"",controller:function(t){t.toInitLayout()}}).when("/stand-by",{template:"",controller:function(t){t.toStandByLayout()}}).when("/side-nav-open",{template:"",controller:function(t,e){t.open(),e.toStandByLayout()}}).when("/powered-by",{template:"",controller:function(t){t.show("Powered By ...","This site is powered by Angular.JS, Node.JS, Nginx @ Aliyun.")}}).when("/",{template:"",controller:function(t,e){t.close()}}).otherwise({redirectTo:"/"})}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0})}])}(),function(t,e){"use strict";var n=angular.module("appToast",[]);n.factory("$toast",["$mdToast","appConfig",function(t,e){var n={};return n.toastPosition=e.toast.position,n.getToastPosition=function(){return Object.keys(n.toastPosition).filter(function(t){return n.toastPosition[t]}).join(" ")},n.showSimpleToast=function(e){t.show(t.simple().content(e).position(n.getToastPosition()).hideDelay(5e3))},n.showActionToast=function(e,o,a){a=a||function(){};var i=t.simple().content(e).action(o).highlightAction(!1).position(n.getToastPosition());t.show(i).then(a)},n.closeToast=function(){t.hide()},n}]);var o=angular.module("charMsg",[]);o.factory("$charMsg",["$timeout","$window","$internalFunc",function(t,e,n){var o=angular.element(document.querySelector("body")),a=!1,i=null,r=null,c={create:function(e,r,l){if(r||n.throwError('param "content" must be provided when calling "$charMsg.show()".'),i&&n.throwError("\n\n Character Message Panel has been created, can't create anymore, so stop calling me before remove it! （╯－＿－）╯╧╧ \n"),!a){a=!0,i=document.createElement("char-msg"),i.className="char-msg";var s=document.createElement("div");switch(s.className="char-msg-container",l=l||"left"){case"left":n.addClass(i,"left");break;case"right":n.addClass(i,"right")}if(e){var u=document.createElement("h2");u.className="char-msg-title",u.innerHTML=e,s.appendChild(u)}var d=document.createElement("div");d.className="char-msg-content",d.innerHTML=r,s.appendChild(d);var m=document.createElement("button");m.className="char-msg-close-btn",m.onclick=c.remove;var f=document.createElement("i");f.className="icon-cancel",m.appendChild(f),s.appendChild(m),i.appendChild(s),o.append(i),t(function(){a=!1},500)}},remove:function(){n.addClass(i,"out-animation"),e.history.back(),r=t(function(){i.parentNode.removeChild(i),i=null},500)}};return{show:c.create,hide:c.remove}}]);var a=angular.module("localStorage",[]);a.factory("$localStorage",function(e,n,o){function a(e,o){e&&o||n.throwError('Params must be provided when calling "$localStorage.setItem()"!  (╯‵□′)╯︵┻━┻'),"[object String]"!==Object.prototype.toString.call(e)&&n.throwError('$localStorage.setItem(): Param "key" must be String.'),t.localStorage.setItem(e,o)}function i(e){return e&&"[object String]"===Object.prototype.toString.call(e)||n.throwError('$localStorage.getItem(): Params "key" is invalid, take a look.'),t.localStorage.getItem(e)}function r(e){e&&"[object String]"===Object.prototype.toString.call(e)||n.throwError('$localStorage.removeItem(): Params "key" is invalid, take a look.'),t.localStorage.removeItem(e)}function c(){Object.keys(t.localStorage).filter(function(t){r(t)}),e.showSimpleToast("搜索历史已成功清空!  (●'◡'●)ﾉ♥"),console.log(o.text.prefix+"Info:\nAll items in Local Storage has been removed at "+new Date(Date.now())+".")}return{setItem:a,getItem:i,removeItem:r,empty:c}});var i=angular.module("leftNav",[]);i.factory("$leftNav",function(e,n,o,a){function i(t){27===t.keyCode&&(u(),l())}function r(){m.unbind("keyup",i)}function c(){e("leftside").toggle().then(function(){}),n(function(){var t=angular.element(document.querySelector("md-backdrop"));t.unbind(),n(function(){t.bind("click",d)},400),e("leftside").isOpen()&&m.bind("keyup",i)},1)}function l(){e("leftside").close(),u("close")}function s(){e("leftside").isOpen()||(c(),u("open"),n(function(){var t=angular.element(document.querySelector("md-backdrop"));t.removeClass("ng-enter")},1))}function u(t){var e=document.getElementById("left-nav-menu"),n={toArrow:function(){var t={startPosition:0,width:27.75,step:16,interval:17};a.imageAnimationX(e,t),e.setAttribute("data-status","arrow"),o.path("/side-nav-open")},toMenu:function(){var t={startPosition:444,endPosition:0,width:27.75,step:16,interval:17};a.imageAnimationX(e,t),e.setAttribute("data-status","menu"),r(),o.path("/")}},i=e.getAttribute("data-status");if(t)switch(t){case"open":if("arrow"===i)return;n.toArrow();break;case"close":if("menu"===i)return;n.toMenu()}else switch(i){case"menu":n.toArrow();break;case"arrow":n.toMenu()}}function d(){return a.imageAnimationX.isRunning?!1:(c(),void u())}var m=angular.element(t);return{toggle:d,open:s,close:l}});var r=angular.module("colorChange",[]);r.factory("$colorChange",function(){function t(t){var e=".color-theme.bk-color {background-color:"+t+"}.color-theme.text-color {color:"+t+"}";n.html(e)}var e=document.getElementById("color-change"),n=angular.element(e);return{change:t}});var c=angular.module("splashLayout",[]);c.factory("$splashLayout",function(){function t(){o.status=n.initLayout}function e(){o.status=n.standBy}var n={initLayout:"init-layout",standBy:"stand-by-layout"},o={status:n.initLayout};return{toInitLayout:t,toStandByLayout:e,layout:o}});var l=angular.module("changeLog",[]);l.factory("$changeLog",["$http","$splashLayout","$leftNav","$toast","$internalFunc","$textPanel",function(t,e,n,o,a,i){function r(){t.post("/change-log").then(function(t){i.show({title:"更新日志",content:t.data.content,backward:!0})},function(t){a.toastErr(o,"更新日志获取失败, 过一会再试试?","(/= _ =)/~┴┴","Request for Change Log failed.")})}return{show:r}}]);var s=angular.module("textPanel",[]);s.factory("$textPanel",["$rootScope",function(t){function e(){console.log("$textPanel Service: \n--- This is a invincible divider. ---"),console.log(' - $textPanel.show(config): Create a text panel and fill it with "content".'),console.log(" - $textPanel.help(): Here comes the help you loser! \n")}function n(e){e=e||"",t.$broadcast("textPanelCreated",e)}return{show:n,help:e}}])}(window),function(t,e,n){function o(){if(!t.io)throw new Error(a+"Error: Socket.io isn't loaded yet, scripts has been stoped.");var e=t.io();e.on("greeting",function(t){console.log(a+"Info: WebSocket from now on. :)"),e.emit("thank-you-sir",{info:"啊♂啊♂Thank♂You♂Sir"})})}var a="Animation Searcher ";e.element(window).on("load",o)}(window,window.angular);