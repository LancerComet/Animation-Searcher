!function(global,undefined){function oldBrowserHint(){throw global.location.href="/old-browser",new Error("Animation Searcher Error: Your Browser is too old, time to change! :)")}if(!angular)throw new Error("Animation Searcher Error: Please make sure Angular.JS is loaded Correctly.");var userAgent=global.navigator.userAgent,oldExpReg=/MSIE [1-8].*]/i;userAgent.match(oldExpReg)?oldBrowserHint():void 0}(window),function(){"use strict";var appConfig=angular.module("appConfig",[]);appConfig.value("appConfig",{text:{prefix:"Animation Searcher "},site:{caso:{name:"华盟",codeName:"caso",fullName:"China Animation Subtitle Organization",url:"https://camoe.org",icon:"http://tp4.sinaimg.cn/1843885343/180/1290319229/0",disabled:!1},ktxp:{name:"极影",codeName:"ktxp",fullName:"Katong XP",url:"http://bt.ktxp.org",icon:"http://tp4.sinaimg.cn/3808818207/180/5680524263/0",disabled:!0},popgo:{name:"漫游",codeName:"popgo",fullName:"Popgo",url:"http://share.popgo.org",icon:"http://tp1.sinaimg.cn/2661910672/180/5727241391/0",disabled:!1},dmhy:{name:"动漫花园",codeName:"dmhy",fullName:"DongMan HuaYuan",url:"https://share.dmhy.org",icon:"http://tp2.sinaimg.cn/1926582581/180/22817929400/0",disabled:!1}},toast:{position:{top:!0,bottom:!1,left:!1,right:!0}},settings:{xhrTimeout:3e4}})}(),function(){"use strict";var ngApp=angular.module("ngApp",["ngAnimate","ngMaterial","ngSanitize","ngRoute","appConfig","internalFunc","ngAppCtrls","ngAppDirectives","ngAppService","ngFrontendRouter","colorThief"]);ngApp.config(["$compileProvider",function($compileProvider){$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|magnet):/)}]),ngApp.run(["$timeout","$splashScreen","$colorChange","$colorThief",function($timeout,$splashScreen,$colorChange,$colorThief){angular.element(window).on("load",function(){var image=document.querySelector("#greeting-background"),themeColor=$colorThief.getThemeColor(image);$timeout(function(){$splashScreen.hide()},3e3),$timeout(function(){$colorChange.change(themeColor)},1e3)})}])}(),function(){function rgbToHsv(r,g,b){1===arguments.length&&(g=r.g,b=r.b,r=r.r);var h,max=Math.max(r,g,b),min=Math.min(r,g,b),d=max-min,s=0===max?0:d/max,v=max/255;switch(max){case min:h=0;break;case r:h=g-b+d*(b>g?6:0),h/=6*d;break;case g:h=b-r+2*d,h/=6*d;break;case b:h=r-g+4*d,h/=6*d}return[h,s,v]}function hsvToRgb(h,s,v){var r,g,b,i,f,p,q,t;switch(1===arguments.length&&(s=h.s,v=h.v,h=h.h),i=Math.floor(6*h),f=6*h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}return[Math.round(255*r),Math.round(255*g),Math.round(255*b)]}var colorThief=angular.module("colorThief",[]);colorThief.factory("$colorThief",function(){var CanvasImage=function(image){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=image.width,this.height=this.canvas.height=image.height,this.context.drawImage(image,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(imageData){this.context.putImageData(imageData,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(sourceImage,quality){var palette=this.getPalette(sourceImage,5,quality);return"rgb("+palette[0][0]+", "+palette[0][1]+", "+palette[0][2]+")"},ColorThief.prototype.getThemeColor=function(sourceImage,quality){var palette=this.getPalette(sourceImage,5,quality),rgbResult={r:palette[0][0],g:palette[0][1],b:palette[0][2]},hsvResult=rgbToHsv(rgbResult.r,rgbResult.g,rgbResult.b),finalColor=[];return hsvResult[2]>.75&&hsvResult[2]<=.85?(hsvResult[2]=.75,hsvResult[1]+=.15,console.log("Animation Searcher Info: The dominant color is too bright, and it has been adjusted."),finalColor=hsvToRgb(hsvResult[0],hsvResult[1],hsvResult[2])):hsvResult[2]>.85?(finalColor=ColorThief.prototype.getDarkestColor(sourceImage,quality),console.log("Animation Searcher Info: The dominant color is too bright, so the darkest color has been set.")):finalColor=hsvToRgb(hsvResult[0],hsvResult[1],hsvResult[2]),"rgb("+finalColor[0]+", "+finalColor[1]+", "+finalColor[2]+")"},ColorThief.prototype.getDarkestColor=function(sourceImage,quality){var palette=this.getPalette(sourceImage,5,quality),colorSum=765,darkestColor=null;return Object.keys(palette).filter(function(eachColor){var sum=palette[eachColor][0]+palette[eachColor][1]+palette[eachColor][2];colorSum>sum&&(colorSum=sum,darkestColor=[palette[eachColor][0],palette[eachColor][1],palette[eachColor][2]])}),darkestColor},ColorThief.prototype.getPalette=function(sourceImage,colorCount,quality){"undefined"==typeof colorCount&&(colorCount=10),("undefined"==typeof quality||1>quality)&&(quality=10);for(var offset,r,g,b,a,image=new CanvasImage(sourceImage),imageData=image.getImageData(),pixels=imageData.data,pixelCount=image.getPixelCount(),pixelArray=[],i=0;pixelCount>i;i+=quality)offset=4*i,r=pixels[offset+0],g=pixels[offset+1],b=pixels[offset+2],a=pixels[offset+3],a>=125&&(r>250&&g>250&&b>250||pixelArray.push([r,g,b]));var cmap=MMCQ.quantize(pixelArray,colorCount),palette=cmap?cmap.palette():null;return image.removeCanvas(),palette},!pv)var pv={map:function(array,f){var o={};return f?array.map(function(d,i){return o.index=i,f.call(o,d)}):array.slice()},naturalOrder:function(a,b){return b>a?-1:a>b?1:0},sum:function(array,f){var o={};return array.reduce(f?function(p,d,i){return o.index=i,p+f.call(o,d)}:function(p,d){return p+d},0)},max:function(array,f){return Math.max.apply(null,f?pv.map(array,f):array)}};var MMCQ=function(){function getColorIndex(r,g,b){return(r<<2*sigbits)+(g<<sigbits)+b}function PQueue(comparator){function sort(){contents.sort(comparator),sorted=!0}var contents=[],sorted=!1;return{push:function(o){contents.push(o),sorted=!1},peek:function(index){return sorted||sort(),void 0===index&&(index=contents.length-1),contents[index]},pop:function(){return sorted||sort(),contents.pop()},size:function(){return contents.length},map:function(f){return contents.map(f)},debug:function(){return sorted||sort(),contents}}}function VBox(r1,r2,g1,g2,b1,b2,histo){var vbox=this;vbox.r1=r1,vbox.r2=r2,vbox.g1=g1,vbox.g2=g2,vbox.b1=b1,vbox.b2=b2,vbox.histo=histo}function CMap(){this.vboxes=new PQueue(function(a,b){return pv.naturalOrder(a.vbox.count()*a.vbox.volume(),b.vbox.count()*b.vbox.volume())})}function getHisto(pixels){var index,rval,gval,bval,histosize=1<<3*sigbits,histo=new Array(histosize);return pixels.forEach(function(pixel){rval=pixel[0]>>rshift,gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,index=getColorIndex(rval,gval,bval),histo[index]=(histo[index]||0)+1}),histo}function vboxFromPixels(pixels,histo){var rval,gval,bval,rmin=1e6,rmax=0,gmin=1e6,gmax=0,bmin=1e6,bmax=0;return pixels.forEach(function(pixel){rval=pixel[0]>>rshift,gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,rmin>rval?rmin=rval:rval>rmax&&(rmax=rval),gmin>gval?gmin=gval:gval>gmax&&(gmax=gval),bmin>bval?bmin=bval:bval>bmax&&(bmax=bval)}),new VBox(rmin,rmax,gmin,gmax,bmin,bmax,histo)}function medianCutApply(histo,vbox){function doCut(color){var left,right,vbox1,vbox2,d2,dim1=color+"1",dim2=color+"2",count2=0;for(i=vbox[dim1];i<=vbox[dim2];i++)if(partialsum[i]>total/2){for(vbox1=vbox.copy(),vbox2=vbox.copy(),left=i-vbox[dim1],right=vbox[dim2]-i,d2=right>=left?Math.min(vbox[dim2]-1,~~(i+right/2)):Math.max(vbox[dim1],~~(i-1-left/2));!partialsum[d2];)d2++;for(count2=lookaheadsum[d2];!count2&&partialsum[d2-1];)count2=lookaheadsum[--d2];return vbox1[dim2]=d2,vbox2[dim1]=vbox1[dim2]+1,[vbox1,vbox2]}}if(vbox.count()){var rw=vbox.r2-vbox.r1+1,gw=vbox.g2-vbox.g1+1,bw=vbox.b2-vbox.b1+1,maxw=pv.max([rw,gw,bw]);if(1==vbox.count())return[vbox.copy()];var i,j,k,sum,index,total=0,partialsum=[],lookaheadsum=[];if(maxw==rw)for(i=vbox.r1;i<=vbox.r2;i++){for(sum=0,j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(i,j,k),sum+=histo[index]||0;total+=sum,partialsum[i]=total}else if(maxw==gw)for(i=vbox.g1;i<=vbox.g2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(j,i,k),sum+=histo[index]||0;total+=sum,partialsum[i]=total}else for(i=vbox.b1;i<=vbox.b2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.g1;k<=vbox.g2;k++)index=getColorIndex(j,k,i),sum+=histo[index]||0;total+=sum,partialsum[i]=total}return partialsum.forEach(function(d,i){lookaheadsum[i]=total-d}),doCut(maxw==rw?"r":maxw==gw?"g":"b")}}function quantize(pixels,maxcolors){function iter(lh,target){for(var vbox,ncolors=1,niters=0;maxIterations>niters;)if(vbox=lh.pop(),vbox.count()){var vboxes=medianCutApply(histo,vbox),vbox1=vboxes[0],vbox2=vboxes[1];if(!vbox1)return;if(lh.push(vbox1),vbox2&&(lh.push(vbox2),ncolors++),ncolors>=target)return;if(niters++>maxIterations)return}else lh.push(vbox),niters++}if(!pixels.length||2>maxcolors||maxcolors>256)return!1;var histo=getHisto(pixels),nColors=0;histo.forEach(function(){nColors++});var vbox=vboxFromPixels(pixels,histo),pq=new PQueue(function(a,b){return pv.naturalOrder(a.count(),b.count())});pq.push(vbox),iter(pq,fractByPopulations*maxcolors);for(var pq2=new PQueue(function(a,b){return pv.naturalOrder(a.count()*a.volume(),b.count()*b.volume())});pq.size();)pq2.push(pq.pop());iter(pq2,maxcolors-pq2.size());for(var cmap=new CMap;pq2.size();)cmap.push(pq2.pop());return cmap}var sigbits=5,rshift=8-sigbits,maxIterations=1e3,fractByPopulations=.75;return VBox.prototype={volume:function(force){var vbox=this;return(!vbox._volume||force)&&(vbox._volume=(vbox.r2-vbox.r1+1)*(vbox.g2-vbox.g1+1)*(vbox.b2-vbox.b1+1)),vbox._volume},count:function(force){var vbox=this,histo=vbox.histo;if(!vbox._count_set||force){var i,j,k,npix=0;for(i=vbox.r1;i<=vbox.r2;i++)for(j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(i,j,k),npix+=histo[index]||0;vbox._count=npix,vbox._count_set=!0}return vbox._count},copy:function(){var vbox=this;return new VBox(vbox.r1,vbox.r2,vbox.g1,vbox.g2,vbox.b1,vbox.b2,vbox.histo)},avg:function(force){var vbox=this,histo=vbox.histo;if(!vbox._avg||force){var hval,i,j,k,histoindex,ntot=0,mult=1<<8-sigbits,rsum=0,gsum=0,bsum=0;for(i=vbox.r1;i<=vbox.r2;i++)for(j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)histoindex=getColorIndex(i,j,k),hval=histo[histoindex]||0,ntot+=hval,rsum+=hval*(i+.5)*mult,gsum+=hval*(j+.5)*mult,bsum+=hval*(k+.5)*mult;ntot?vbox._avg=[~~(rsum/ntot),~~(gsum/ntot),~~(bsum/ntot)]:vbox._avg=[~~(mult*(vbox.r1+vbox.r2+1)/2),~~(mult*(vbox.g1+vbox.g2+1)/2),~~(mult*(vbox.b1+vbox.b2+1)/2)]}return vbox._avg},contains:function(pixel){var vbox=this,rval=pixel[0]>>rshift;return gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,rval>=vbox.r1&&rval<=vbox.r2&&gval>=vbox.g1&&gval<=vbox.g2&&bval>=vbox.b1&&bval<=vbox.b2}},CMap.prototype={push:function(vbox){this.vboxes.push({vbox:vbox,color:vbox.avg()})},palette:function(){return this.vboxes.map(function(vb){return vb.color})},size:function(){return this.vboxes.size()},map:function(color){for(var vboxes=this.vboxes,i=0;i<vboxes.size();i++)if(vboxes.peek(i).vbox.contains(color))return vboxes.peek(i).color;return this.nearest(color)},nearest:function(color){for(var d1,d2,pColor,vboxes=this.vboxes,i=0;i<vboxes.size();i++)d2=Math.sqrt(Math.pow(color[0]-vboxes.peek(i).color[0],2)+Math.pow(color[1]-vboxes.peek(i).color[1],2)+Math.pow(color[2]-vboxes.peek(i).color[2],2)),(d1>d2||void 0===d1)&&(d1=d2,pColor=vboxes.peek(i).color);return pColor},forcebw:function(){var vboxes=this.vboxes;vboxes.sort(function(a,b){return pv.naturalOrder(pv.sum(a.color),pv.sum(b.color))});var lowest=vboxes[0].color;lowest[0]<5&&lowest[1]<5&&lowest[2]<5&&(vboxes[0].color=[0,0,0]);var idx=vboxes.length-1,highest=vboxes[idx].color;highest[0]>251&&highest[1]>251&&highest[2]>251&&(vboxes[idx].color=[255,255,255])}},{quantize:quantize}}();return new ColorThief})}(),function(){"use strict";var ngAppCtrls=angular.module("ngAppCtrls",[]);ngAppCtrls.controller("mainController",["$scope","$rootScope","$location","$timeout","$resultCheck",function($scope,$rootScope,$location,$timeout,$resultCheck){function checkAllResult(){$resultCheck.checkAll()}function linkCopy(){$resultCheck.linkCopy()}$scope.blurButton="hide",$scope.historyPanel=!1,$scope.resultPanelIf={},$scope.layout="init-layout",$scope.$on("splashLayout",function(event,value){$scope.layout=value,"init-layout"!==value&&($timeout.cancel($scope.blurButtonTimeout),$scope.blurButton="hide")}),$scope.$on("splashScreen",function(event,value){$timeout(function(){$scope.backgroundBlur="blur",$scope.blurButtonTimeout=$timeout(function(){$scope.blurButton="show"},5e3)},4e3)}),$scope.toggleBlur=function(){"blur"===$scope.backgroundBlur?$scope.backgroundBlur="":$scope.backgroundBlur="blur"},$scope.$on("historyPanel",function(event,value){"show"===value?$scope.historyPanel=!0:$scope.historyPanel=!1}),$scope.resultToolbar={show:!1,open:!0,mode:"md-scale",copyLinkButton:!1,checkAllResult:checkAllResult,linkCopy:linkCopy,forceOpen:function(){$scope.resultToolbar.open=!0}},$scope.$on("resultToolbar",function(event,value){$timeout(function(){$scope.resultToolbar.show=value},1e3)}),$scope.$on("showCopyLinkButton",function(event,value){$scope.resultToolbar.copyLinkButton=value})}]),ngAppCtrls.controller("resultPanelController",["$scope","appConfig",function($scope,appConfig){$scope.panelShow={},Object.keys(appConfig.site).filter(function(item){var codeName=appConfig.site[item].codeName;$scope.panelShow[codeName]=!1});var panelIn=!1;$scope.$on("searchResult",function(event,value){if(!panelIn){var codeName=value.codeName;$scope.panelShow[codeName]=!0,panelIn=!0}}),$scope.$on("resultPanelSwitching",function(event,value){Object.keys($scope.panelShow).filter(function(item){$scope.panelShow[item]=!1,value===item?$scope.panelShow[item]=!0:void 0})})}]),ngAppCtrls.controller("leftNavButtonCtrl",["$scope","$localStorage",function($scope,$localStorage){$scope.clearHistory=function(){$localStorage.empty()}}]),ngAppCtrls.controller("splashScreenController",["$scope",function($scope){$scope.status=null,$scope.$on("splashScreen",function(event,value){$scope.status=value})}]),ngAppCtrls.controller("serviceModules",["$scope",function($scope){}])}(),function(){"use strict";var ngAppDirectives=angular.module("ngAppDirectives",[]);ngAppDirectives.directive("actionBar",[function(){return{restrict:"E",scope:{},controller:function($scope,$element,$attrs){},link:function(scope,element,attrs){}}}]),ngAppDirectives.directive("leftnavMenu",["$leftNav",function($leftNav){return{restrict:"E",scope:!0,controller:function($scope,$element,$attrs){},link:function(scope,element,attrs){scope.toggle=$leftNav.toggle}}}]),ngAppDirectives.directive("searchBar",["$http","$toast","$search","$splashLayout",function($http,$toast,$search,$splashLayout){return{restrict:"E",scope:!0,controller:function($scope,$element,$attrs){},link:function(scope,element,attrs){function searchBarFocus(){initStatus||($splashLayout.toStandByLayout(),initStatus=!0)}var initStatus=!1;scope.keywords=null,scope.searchExec=function($event){return"keyup"===$event.type&&13!==$event.keyCode?!1:void $search.search(scope.keywords)},scope.searchBarFocus=searchBarFocus}}}]),ngAppDirectives.directive("siteSwitcher",["$timeout","appConfig","$resultPanelSwitching",function($timeout,appConfig,$resultPanelSwitching){return{restrict:"E",scope:!0,replace:!1,templateUrl:"/templates/ng-site-switcher.html",controller:function($scope,$element,$attrs){$scope.panelSwitch=function(codeName){codeName?void 0:throwError('Please provide param "codeName" while calling this function.')}},link:function(scope,element,attrs){scope.siteList=appConfig.site,Object.keys(scope.siteList).filter(function(prop){scope.siteList[prop].title="切换至"+scope.siteList[prop].name+"的搜索结果",scope.siteList[prop].hideProgressbar=!0}),scope.$on("searchStart",function(event,value){value.showSwitcher===!0?scope.siteSwitcherShow=!0:void 0}),scope.panelSwitch=function($event){"true"===$event.target.attributes["data-disabled"].value.toString()?void 0:$resultPanelSwitching($event.target.attributes["data-codename"].value)},scope.$on("searchStart",function(event,value){scope.siteList[value.codeName].hideProgressbar=!1}),scope.$on("searchResult",function(event,value){var codeName=value.codeName;scope.siteList[codeName].hideProgressbar=!0,200===value.status?scope.siteList[codeName].eventType="success":404===value.status?scope.siteList[codeName].eventType="caution":scope.siteList[codeName].eventType="failed",$timeout(function(){scope.siteList[codeName].eventType="none"},500)})}}}]),ngAppDirectives.directive("resultPanel",["$compile","$sce","$search","$resultCheck","appConfig",function($compile,$sce,$search,$resultCheck,appConfig){return{restrict:"E",scope:!0,templateUrl:"/templates/ng-result-panel.html",controller:function($scope,$element,$attrs){$scope.switchPage=function($event,targetSite){$search.changePage(targetSite,$event.target.attributes["data-request-link"].value)},$scope.resultCheckbox=function(magnetLink){$resultCheck.checkIt(magnetLink)}},link:function(scope,element,attrs){attrs.codename?void 0:throwError('Attribute "codename" must be defined.');var codeName=attrs.codename;scope.domInfo={codeName:codeName,name:appConfig.site[codeName].name,fullName:appConfig.site[codeName].fullName,icon:appConfig.site[codeName].icon,disabled:appConfig.site[codeName].disabled},scope.$on("searchResult",function(event,value){if(!value[codeName])return!1;scope.results=value[codeName];var $pagination=angular.element(document.querySelector(".result-pagination-"+codeName));$pagination.html(value[codeName].pageLink),$compile($pagination)(scope)}),scope.$on("checkAllResult",function(event,value){"false"!==attrs.show.toString()&&setTimeout(function(){for(var checkBoxs=document.querySelectorAll(".result-panel[data-show=true] md-checkbox"),selectTimeout=0,i=0,length=checkBoxs.length;length>i;i++)!function(j){setTimeout(function(){checkBoxs[j].click()},selectTimeout),selectTimeout+=20}(i)},1)})}}}]),ngAppDirectives.directive("textPanel",["$compile","$timeout","$window","$toast","$clearMDToast",function($compile,$timeout,$window,$toast,$clearMDToast){return{restrict:"E",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){}],link:function(scope,element,attrs){function createPanel(config){config.content?void 0:$toast.showSimpleToast("Caution: No content provided.");var nodes='<div class="main-container w-100 h-100 p-absolute p-zero bk-merge md-whiteframe-4dp" style="z-index: 10000"><div class="content-container p-relative"><h2 class="title color-theme bk-color">'+config.title+'</h2><md-button class="md-icon-button close-btn transition-dot-4" style="margin-top: .5em;" ng-click="closePanel()" aria-label="Close this panel."><md-tooltip>关闭面板</md-tooltip><i class="icon-cancel"></i></md-button><div class="content">'+config.content+"</div></div></div>";config.resultPanel&&(nodes='<div class="main-container w-100 h-100 p-absolute p-zero bk-merge md-whiteframe-4dp" style="z-index: 10000"><div class="content-container p-relative"><h2 class="title color-theme bk-color">'+config.title+'</h2><md-button class="md-icon-button close-btn transition-dot-4" style="margin-top: .5em;" ng-click="closePanel()" aria-label="Close this panel."><md-tooltip>关闭面板</md-tooltip><i class="icon-cancel"></i></md-button><textarea class="content" style="width: calc(100% - 4em); resize: none;" onclick="this.focus(); this.select();">'+config.content+"</textarea></div></div>"),element.append($compile(nodes)(scope)),scope.panelStatus="in",scope.closePanel=function(){config.backward?$window.history.back():void 0,scope.panelStatus="out",$timeout(function(){angular.element(element).empty(),$clearMDToast()},600)}}scope.closePanel=null,scope.panelStatus="out",scope.$on("textPanelCreated",function(event,object){createPanel(object)})}}}]),ngAppDirectives.directive("history",["$localStorage",function($localStorage){return{restrict:"E",scope:!0,controller:function($scope,$element,$attrs){},link:function(scope,element,attrs){}}}]),ngAppDirectives.directive("dynamicBackground",[function(){return{restrict:"E",templateUrl:"/templates/ng-dynamic-bk.html",controller:function($scope,$element,$attrs){},link:function(scope,element,attrs){}}}])}(),function(){"use strict";var internalFunc=angular.module("internalFunc",[]);internalFunc.factory("$internalFunc",["$interval","$window","appConfig",function($interval,$window,appConfig){function throwError(text){throw new Error(appConfig.text.prefix+"Error: "+text)}function $toastFunc($toast,type,content,action,callback){switch($toast&&type||throwError('Argument "$toast" or "type" is not provided in $toastErr.'),content||console.log(appConfig.text.prefix+"Caution: No toast content provided."),content=content||"（木有提供提示消息~）",callback=callback||void 0,type){case"simple":$toast.showSimpleToast(content);break;case"action":action?void 0:throwError('Please provide parama "action" when calling '+callback),$toast.showActionToast(content,action,callback)}}function $toastErr($toast,content,action,consoleErr){$toastFunc($toast,"action",content,action,function(){throwError(consoleErr)})}function imageAnimationX(targetDom,configure){imageAnimationX.isRunning=!1,imageAnimationX.isRunning=!0,targetDom.style.backgroundPositionX=configure.startPosition+"px";var runStep=1,intervalFunc=function(){return runStep>configure.step?(void 0!=configure.endPosition?targetDom.style.backgroundPositionX=configure.endPosition+"px":void 0,$window.navigator.userAgent.indexOf("Firefox")>-1&&(void 0!=configure.endPosition?targetDom.style.backgroundPosition=configure.endPosition+"px 0":void 0),$interval.cancel(theInterval),void(imageAnimationX.isRunning=!1)):(targetDom.style.backgroundPositionX=configure.startPosition+configure.width*runStep+"px",$window.navigator.userAgent.indexOf("Firefox")>-1&&(targetDom.style.backgroundPosition=configure.startPosition+configure.width*runStep+"px 0"),void runStep++)},theInterval=$interval(intervalFunc,configure.interval)}function hasClass(element,className){return!!element.className.match(new RegExp("(\\s|^)"+className+"(\\s|$)"))}function addClass(element,className){hasClass(element,className)||(element.className+=" "+className)}function removeClass(element,className){hasClass(element,className)&&(element.className=element.className.replace(new RegExp("(\\s|^)"+className+"(\\s|$)")," "))}function setClass(element,className){element.className=className}function prependChild(parent,newChild){return parent.firstChild?parent.insertBefore(newChild,parent.firstChild):parent.appendChild(newChild),parent}return{throwError:throwError,toastFunc:$toastFunc,toastErr:$toastErr,imageAnimationX:imageAnimationX,hasClass:hasClass,addClass:addClass,removeClass:removeClass,setClass:setClass,prependChild:prependChild}}])}(),function(){"use strict";var ngFrontendRouter=angular.module("ngFrontendRouter",[]);ngFrontendRouter.config(["$routeProvider",function($routeProvider){$routeProvider.when("/change-log",{template:"",controller:["$changeLog",function($changeLog){$changeLog.show()}]}).when("/welcome",{template:"",controller:["$splashLayout",function($splashLayout){$splashLayout.toInitLayout()}]}).when("/stand-by",{template:"",controller:["$splashLayout",function($splashLayout){$splashLayout.toStandByLayout()}]}).when("/side-nav-open",{template:"",controller:["$leftNav","$splashLayout",function($leftNav,$splashLayout){$leftNav.open()}]}).when("/powered-by",{template:"",controller:["$charMsg",function($charMsg){$charMsg.show("Powered By ...","This site is powered by Angular.JS, Node.JS, Nginx @ Aliyun.")}]}).when("/",{template:"",controller:["$leftNav",function($leftNav){$leftNav.close()}]}).otherwise({redirectTo:"/"})}]).config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode({enabled:!0})}])}(),function(global,undefined){"use strict";angular.module("ngAppService",["appToast","charMsg","leftNav","colorChange","localStorage","splashLayout","splashScreen","changeLog","textPanel","clearMdToast","historyPanel","searchService","resultPanelSwitching","resultChecking"]);var appToast=angular.module("appToast",[]);appToast.factory("$toast",["$mdToast","appConfig",function($mdToast,appConfig){var toastModule={};return toastModule.toastPosition=appConfig.toast.position,toastModule.getToastPosition=function(){return Object.keys(toastModule.toastPosition).filter(function(pos){return toastModule.toastPosition[pos]}).join(" ")},toastModule.showSimpleToast=function(toastContent){$mdToast.show($mdToast.simple().content(toastContent).position(toastModule.getToastPosition()).hideDelay(5e3))},toastModule.showActionToast=function(toastContent,toastAction,callback){callback=callback||function(){};var toast=$mdToast.simple().content(toastContent).action(toastAction).highlightAction(!1).position(toastModule.getToastPosition());$mdToast.show(toast).then(callback)},toastModule.closeToast=function(){$mdToast.hide()},toastModule}]);var charMsg=angular.module("charMsg",[]);charMsg.factory("$charMsg",["$timeout","$window","$internalFunc",function($timeout,$window,$internalFunc){var $body=angular.element(document.querySelector("body")),isRunning=!1,charMsgNode=null,$removeTimeout=null,charMsg={create:function(title,content,position){if(content||$internalFunc.throwError('param "content" must be provided when calling "$charMsg.show()".'),charMsgNode&&$internalFunc.throwError("\n\n Character Message Panel has been created, can't create anymore, so stop calling me before remove it! （╯－＿－）╯╧╧ \n"),!isRunning){isRunning=!0,charMsgNode=document.createElement("char-msg"),charMsgNode.className="char-msg";var container=document.createElement("div");switch(container.className="char-msg-container",position=position||"left"){case"left":$internalFunc.addClass(charMsgNode,"left");break;case"right":$internalFunc.addClass(charMsgNode,"right")}if(title){var titleNode=document.createElement("h2");titleNode.className="char-msg-title",titleNode.innerHTML=title,container.appendChild(titleNode)}var contentNode=document.createElement("div");contentNode.className="char-msg-content",contentNode.innerHTML=content,container.appendChild(contentNode);var closeButton=document.createElement("button");closeButton.className="char-msg-close-btn",closeButton.onclick=charMsg.remove;var btnIcon=document.createElement("i");btnIcon.className="icon-cancel",closeButton.appendChild(btnIcon),container.appendChild(closeButton),charMsgNode.appendChild(container),$body.append(charMsgNode),$timeout(function(){isRunning=!1},500)}},remove:function(){$internalFunc.addClass(charMsgNode,"out-animation"),$window.history.back(),$removeTimeout=$timeout(function(){charMsgNode.parentNode.removeChild(charMsgNode),charMsgNode=null},500)}};return{show:charMsg.create,hide:charMsg.remove}}]);var localStorage=angular.module("localStorage",[]);localStorage.factory("$localStorage",["$toast","$internalFunc","appConfig",function($toast,$internalFunc,appConfig){function setItem(key,value){key&&value||$internalFunc.throwError('Params must be provided when calling "$localStorage.setItem()"!  (╯‵□′)╯︵┻━┻'),"[object String]"!==Object.prototype.toString.call(key)&&$internalFunc.throwError('$localStorage.setItem(): Param "key" must be String.'),global.localStorage.setItem(key,value)}function getItem(key){return key&&"[object String]"===Object.prototype.toString.call(key)||$internalFunc.throwError('$localStorage.getItem(): Params "key" is invalid, take a look.'),global.localStorage.getItem(key)}function removeItem(key){key&&"[object String]"===Object.prototype.toString.call(key)||$internalFunc.throwError('$localStorage.removeItem(): Params "key" is invalid, take a look.'),global.localStorage.removeItem(key)}function empty(){Object.keys(global.localStorage).filter(function(key){removeItem(key)}),$toast.showSimpleToast("搜索历史已成功清空!  (●'◡'●)ﾉ♥"),console.log(appConfig.text.prefix+"Info:\nAll items in Local Storage has been removed at "+new Date(Date.now())+".")}return{setItem:setItem,getItem:getItem,removeItem:removeItem,empty:empty}}]);var leftNav=angular.module("leftNav",[]);leftNav.factory("$leftNav",["$timeout","$mdSidenav","$location","$internalFunc",function($timeout,$mdSidenav,$location,$internalFunc){function keyboardCloseLeftNav(event){27===event.keyCode&&(toggleButton(),closeBar())}function unbindKeyboardCloseLeftNav(){$window.unbind("keyup",keyboardCloseLeftNav)}function toggleBar(){$mdSidenav("leftside").toggle().then(function(){}),$timeout(function(){var $mdBackdrop=angular.element(document.querySelector("md-backdrop"));$mdBackdrop.unbind(),$timeout(function(){$mdBackdrop.bind("click",toggleFunc)},400),$mdSidenav("leftside").isOpen()&&$window.bind("keyup",keyboardCloseLeftNav)},1)}function closeBar(){$mdSidenav("leftside").close(),toggleButton("close")}function openBar(){$mdSidenav("leftside").isOpen()||(toggleBar(),toggleButton("open"),$timeout(function(){var $mdBackdrop=angular.element(document.querySelector("md-backdrop"));$mdBackdrop.removeClass("ng-enter")},1))}function toggleButton(mode){var targetDom=document.getElementById("left-nav-menu"),setLeftNavMenu={toArrow:function(){var configuration={startPosition:0,width:27.75,step:16,interval:17};$internalFunc.imageAnimationX(targetDom,configuration),targetDom.setAttribute("data-status","arrow"),$location.path("/side-nav-open")},toMenu:function(){var configuration={startPosition:444,endPosition:0,width:27.75,step:16,interval:17};$internalFunc.imageAnimationX(targetDom,configuration),targetDom.setAttribute("data-status","menu"),unbindKeyboardCloseLeftNav(),$location.path("/")}},attr=targetDom.getAttribute("data-status");if(mode)switch(mode){case"open":if("arrow"===attr)return;setLeftNavMenu.toArrow();break;case"close":if("menu"===attr)return;setLeftNavMenu.toMenu()}else switch(attr){case"menu":setLeftNavMenu.toArrow();break;case"arrow":setLeftNavMenu.toMenu()}}function toggleFunc(){return $internalFunc.imageAnimationX.isRunning?!1:(toggleBar(),void toggleButton())}var $window=angular.element(global);return{toggle:toggleFunc,open:openBar,close:closeBar}}]);var colorChange=angular.module("colorChange",[]);colorChange.factory("$colorChange",[function(){function colorChange(color){var sheetString=".color-theme.bk-color {background-color:"+color+";color: #fff !important;}.color-theme.text-color {color:"+color+" !important}.color-theme.text-hover:hover {color:"+color+" !important}";$colorThemeSheet.html(sheetString)}var colorThemeSheet=document.getElementById("color-change"),$colorThemeSheet=angular.element(colorThemeSheet);return{change:colorChange}}]);var splashLayout=angular.module("splashLayout",[]);splashLayout.factory("$splashLayout",["$rootScope",function($rootScope){function toInitLayout(){$rootScope.$broadcast("splashLayout","init-layout")}function toStandByLayout(){$rootScope.$broadcast("splashLayout","stand-by-layout")}return{toInitLayout:toInitLayout,toStandByLayout:toStandByLayout}}]);var changeLog=angular.module("changeLog",[]);changeLog.factory("$changeLog",["$http","$splashLayout","$leftNav","$toast","$internalFunc","$textPanel",function($http,$splashLayout,$leftNav,$toast,$internalFunc,$textPanel){function showChangeLog(){$http.post("/change-log").then(function(response){$textPanel.show({title:"更新日志 <small>Change Log.</small>",content:response.data.content,backward:!0})},function(response){$internalFunc.toastErr($toast,"更新日志获取失败, 过一会再试试?","(/= _ =)/~┴┴","Request for Change Log failed.")})}return{show:showChangeLog}}]);var textPanel=angular.module("textPanel",[]);textPanel.factory("$textPanel",["$rootScope",function($rootScope){function showHelp(){console.log("$textPanel Service: \n--- This is a invincible divider. ---"),console.log(' - $textPanel.show(config): Create a text panel and fill it with "config.content".'),
console.log(" - $textPanel.help(): Here comes the help you loser! \n")}function show(config){config=config||"",$rootScope.$broadcast("textPanelCreated",config)}return{show:show,help:showHelp}}]);var clearMdToast=angular.module("clearMdToast",[]);clearMdToast.factory("$clearMDToast",[function(){return function(){angular.element(document.querySelector(".md-content")).remove()}}]);var splashScreen=angular.module("splashScreen",[]);splashScreen.factory("$splashScreen",["$rootScope",function($rootScope){function exec(){$rootScope.$broadcast("splashScreen",arguments[0])}return{show:exec.bind(0,"show"),hide:exec.bind(0,"hide")}}]);var historyPanel=angular.module("historyPanel",[]);historyPanel.factory("$historyPanel",["$rootScope",function($rootScope){function exec(){$rootScope.$broadcast("historyPanel",arguments[0])}return{show:exec.bind(0,"show"),hide:exec.bind(0,"hide")}}]);var searchService=angular.module("searchService",[]);searchService.factory("$search",["$rootScope","$http","$toast","$splashLayout","appConfig",function($rootScope,$http,$toast,$splashLayout,appConfig){function searchBroadCasting(codeName){$rootScope.$broadcast("searchStart",{codeName:codeName,showSwitcher:!0})}function search(keywords){Object.keys(appConfig.site).filter(function(prop){if(appConfig.site[prop].disabled!==!0){var codeName=appConfig.site[prop].codeName;searchBroadCasting(codeName),$http.post("/search/"+codeName,{keywords:keywords},{timeout:appConfig.settings.xhrTimeout}).success(function(data,status,headers,config,statusText){$rootScope.$broadcast("searchResult",data),$toast.showSimpleToast(data.info),resultToolbarCtrl(!0)}).error(function(data,status,headers,config,statusText){-1===status?$toast.showActionToast("您的搜索请求超时，不兹道四哪里粗了问题 ... ＞︿＜","我知道了~"):$toast.showActionToast(data.info,data.action),$rootScope.$broadcast("searchResult",{codeName:prop,status:data.status})})}})}function changePage(codename,link){searchBroadCasting(codename),$http.post("/search/"+codename,{mode:"switchPage",link:link},{timeout:appConfig.settings.xhrTimeout}).success(function(data,status,headers,config,statusText){$rootScope.$broadcast("searchResult",data),$toast.showSimpleToast(data.info)}).error(function(data,status,headers,config,statusText){-1===status?$toast.showActionToast("您的搜索请求超时，不兹道四哪里粗了问题 ... ＞︿＜","我知道了~"):$toast.showActionToast(data.info,data.action),$rootScope.$broadcast("searchResult",{codeName:codename,status:data.status})})}function resultToolbarCtrl(value){$rootScope.$broadcast("resultToolbar",value)}return{search:search,changePage:changePage}}]);var resultPanelSwitching=angular.module("resultPanelSwitching",[]);resultPanelSwitching.factory("$resultPanelSwitching",["$rootScope",function($rootScope){function resultPanelSwitching(codeName){$rootScope.$broadcast("resultPanelSwitching",codeName)}return resultPanelSwitching}]);var resultChecking=angular.module("resultChecking",[]);resultChecking.factory("$resultCheck",["$rootScope","$internalFunc","$textPanel",function($rootScope,$internalFunc,$textPanel){function checkIt(magnetLink){magnetLink?void 0:$internalFunc.throwError("magnetLink must be provided when calling $resultCheck.checkIt()."),selectedMagnet.indexOf(magnetLink)<0?selectedMagnet.push(magnetLink):selectedMagnet.splice(selectedMagnet.indexOf(magnetLink),1),copyLinkButtonCtrl()}function checkAll(){$rootScope.$broadcast("checkAllResult")}function copyLinkButtonCtrl(){selectedMagnet.length>0?$rootScope.$broadcast("showCopyLinkButton",!0):$rootScope.$broadcast("showCopyLinkButton",!1)}function linkCopy(){$textPanel.show({title:"复制链接",content:selectedMagnet.join("\n"),resultPanel:!0})}var selectedMagnet=[];return{checkIt:checkIt,checkAll:checkAll,linkCopy:linkCopy}}])}(window),function(global,angular,undefined){function socketService(){if(!global.io)throw new Error(consoleTextPrefix+"Error: Socket.io isn't loaded yet, scripts has been stoped.");var socket=global.io();socket.on("greeting",function(data){console.log(consoleTextPrefix+"Info: WebSocket from now on. :)"),socket.emit("thank-you-sir",{info:"啊♂啊♂Thank♂You♂Sir"})})}var consoleTextPrefix="Animation Searcher ";angular.element(window).on("load",socketService)}(window,window.angular);